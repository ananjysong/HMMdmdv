{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Usage Tips\"\nauthor: \"Junyan Song\"\ndate: \"`r Sys.Date()`\"\noutput: \npdf_document:\nfig_width: 7\nfig_height: 6\nvignette: >\n  %\\VignetteIndexEntry{Vignette Title}\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteEncoding{UTF-8}\n---\n\n## Introduction\n\nThis is an example of using HMMdmdv package in R. HMMdmdv implements Hidden Markov Model for large-scale multiple testing of differential mean and variance in the framework of a proposed hierarchical mixture model. This vignette aims to demonstrate the usage of HMMdmdv through some example codes and example data. \n\n\n## Usage of HMMdmdv\n\n### (1) installation\n```\ninstall.packages(\"HMMdmdv_0.1.1.tar.gz\", repos = NULL, type=\"source\")\n```\n\n\n### (2) loading example data\nThe example dataset has 1000 rows for 1000 test sites and 100 columns for 100 samples. In each individual test, we are comparing the first 50 samples with the second 50 samples. \n```{r}\nlibrary(HMMdmdv)\n# Loading dataset\ndata(example_data)\n# Check dataset\nexample_data[1:10, 1:8]\ndim(example_data)\n# 1000 tests, 50 samples in each group\nn<-1000\nn1 <- 50\nn2 <- 50\n```\n\n\n\n\n\n\n\n### (3) Initial (heuristic) parameter estimate\n\n```{r}\n# remove case 3\ndata_df <- remove_case3(dat = example_data, mean_thresholdPV = 0.1, var_thresholdPV = 0.05, n1 = n1, n2 = n2)\n# parameter estimate\ninit_para_est <- init_est(dat_df = data_df, mean_thresholdPV = 0.05, var_thresholdPV = 0.1, n1 = n1, n2 = n2, n = n)\n\n```     \n\n\n### (4) Independent Gaussian Mixture parameter estimate\n```{r message=FALSE, warning=FALSE}\n# upper limit of EM iterations\nniter<-1000\n# parameter estimate\nindep_para_est <- runEM(dat_df = data_df, n1 = n1, n2 = n2, init_para_est= init_para_est, niter = niter)\n```\n\n### (5) Calculate emission densities \n```{r}\nemissions <- emission_probs(indep_para_est[5], indep_para_est[6], indep_para_est[7], indep_para_est[8], example_data, n1 = n1, n2 = n2)\nhead(emissions, 10)\n```\n\n   \n\n\n### (6) HMM parameter estimates \n```{r}\nHMM_resList <- runHMM(emissions)\n\n```\n\n### (7) Posterior inference of hidden states \n```{r}\nresult <- posterior_inference(HMM_resList[[1]], HMM_resList[[2]], train = FALSE)\n\nhead(result, 10)\n```\n\n\n\n## More Information\nDetails for arguments and functions can be found by typing e.g. `help(package=\"HMMdmdv\")`, `?runEM`.  \n",
    "created" : 1512650719111.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3980407374",
    "id" : "A00F7B4D",
    "lastKnownWriteTime" : 1512660998,
    "last_content_update" : 1512660998006,
    "path" : "~/HMMdmdv/vignettes/vignette.Rmd",
    "project_path" : "vignettes/vignette.Rmd",
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}